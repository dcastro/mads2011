<p id="notice"><%= notice %></p>

<div id="open_suggestion">
	Suggestion <%= image_tag "thought_bubble.png", height: '25'%>
</div>

<h2 id="feature" data-projectid="<%= @feature.project.id %>"> <%= link_to @feature.project.name, project_path(@feature.project) %> > <%= @feature.name %></h2>
<h3> <%= @feature.description %></h3>

<%= render partial: "suggestion_scenarios/form"%>

	<% @feature.scenarios.each do |scenario| %>
		<h5 class="scenario_head" <%= (scenario.completed)? "style=background-color:#36D88E;": "style=background-color:#FF5D40;" %>>
			<%= scenario.name %>: <%= scenario.description %>
		</h5>
		<div class="scenario_body">
		<% scenario.steps.each do |step|%>
			
				
				<p class="<%= step.status%>"><label style="color:blue"><%= step.keyword %></label> <%= step.name%><p>
				<table class="step_table" rules="cols">
					<% step.step_rows.each_with_index do |row, index|%>
						<%if index%2 == 0%>
							<tr class="odd">
				            	<% row.step_cells.each do |cell|%>
				            		<td><%= cell.name %></td>
				            	<%end%>
			                </tr>
			            <%else%>
			            	<tr class="even">
				            	<% row.step_cells.each do |cell|%>
				            		<td><%= cell.name %></td>
				            	<%end%>
			                </tr>
			            <%end%>
	                <%end%>
                </table>
				<%if step.error_msg != "" %>
					<p style="background-color:red;"> <%= step.error_msg%><p>
				<%end %>
		
		<%end%>
		
		<% if scenario.example %>
			<div class="example">
				<h5>Examples</h5>
				<table class="example_table" rules="cols">
					<tr class = "example1strow">
						<% scenario.example.example_rows.first.example_cells.each do |cell| %>
							<th><%= cell.name %></th>
						<% end %>
					</tr>
					<% rows = scenario.example.example_rows %>
					<% rows.shift %>
					<% rows.each_with_index do |row, index|%>
						<%if index%2 == 0%>
							<tr class="even">
				            	<% row.example_cells.each do |cell|%>
				            		<td><%= cell.name %></td>
				            	<%end%>
			                </tr>
			            <%else%>
			            	<tr class="odd">
				            	<% row.example_cells.each do |cell|%>
				            		<td><%= cell.name %></td>
				            	<%end%>
			                </tr>
			            <%end%>
		            <%end%>
		        </table>
		    </div>
        <% end %>
		
		
		</div>
	<% end %>


	
	<% @feature.suggestion_scenarios.each do |scenario| %>
	
		<h5 class="scenario_head" style="background-color:#AAAAAA;" >
			<%= form_tag suggestion_scenarios_destroy_path(suggestion_scenario_id: scenario.id), class: "destroy_suggestion" do %>
			<% end %>
			
			<%= image_tag('thrash_can.png', height: '25', class: 'thrash_can') %>
			
			<%= image_tag "under_construction-1.png", height: '20'%>
			
			<%= scenario.name %>: <%= scenario.description %>
		</h5>
		
		<div class="scenario_body">
			<div class="suggestion_author">
				Suggested by <%= link_to scenario.user.name, users_show_path(id: scenario.user.id) %>
			</div>
			<div class="try_running">
				<%= button_to "Try running", suggestion_scenarios_run_test_path(id: scenario.id) %>
			</div>
		<% scenario.suggestion_steps.each do |step|%>
				
				<p class="<%= step.status%>"><label style="color:blue"><%= step.keyword %></label> <%= step.name%><p>
				
				<table class="step_table" rules="cols">
					<% step.suggestion_rows.each do |row|%>
						<%if row.row_num%2 == 0%>
							<tr class="even">
				            	<% row.suggestion_cells.each do |cell|%>
				            		<td><%= cell.name %></td>
				            	<%end%>
			                </tr>
			            <%else%>
			            	<tr class="odd">
				            	<% row.suggestion_cells.each do |cell|%>
				            		<td><%= cell.name %></td>
				            	<%end%>
			                </tr>
			            <%end%>
	                <%end%>
                </table>
                <%if step.error_msg != "" %>
					<p style="background-color:red;"> <%= step.error_msg%><p>
				<%end %>
		
		<%end%>
		</div>
	<% end %>

	
<%= link_to 'fad', comments_index_path, remote: true %>


<script>
	<%= render(file: "comments/form.js.coffee", locals: { feature: @feature }).html_safe %>
	<%= render(file: "comments/index.js.coffee", locals: { comments: @feature.comments }).html_safe %>
	
</script>

